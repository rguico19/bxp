function setAdjustment() {
	var adjustments = "{!rate_adjustment_sequence}";
	var roomRate = ( Number("{!R236375.new_room_rate}") > 0 ? Number("{!R236375.new_room_rate}") : Number("{!room_rate}") ), rateAdjustment = 0,
	objName = "discount_item", totalResult = 0, adjustedRate = 0, nights = Number("{!nights}");
	if(adjustments != "") {
		adjustments = adjustments.split(",");
		if(Array.isArray(adjustments) == false) { adjustments = [adjustments]; }
		for (var count in adjustments) {
				var objId = parseInt(adjustments[count]),
				overRide = rbv_api.getFieldValue(objName,objId,"override_room_rate_amount"),
                newRate = Number(rbv_api.getFieldValue(objName,objId,"new_room_rate")),
				amount = Number(rbv_api.getFieldValue(objName, objId, 'amount')),
				percent = Number(rbv_api.getFieldValue(objName, objId, 'percentage')),
				discountMode = rbv_api.getFieldValue(objName, objId, 'disc_mode'),
				discountCode = String(rbv_api.getCodeById(objName, 'disc_mode', discountMode)),
				newRate = Number(rbv_api.getFieldValue(objName, objId, "new_room_rate"));
				
				if (discountCode == "F") {
					if (overRide > 0) roomRate = newRate; //If there is an override rate, use it
					else rateAdjustment += amount; //If the discount is Fixed, add the amount
				} else rateAdjustment += roomRate * (percent / 100);			
				//If the discount is percentage add the value of the rate * % to the total adjustment
			
		}		
			
		if(isNaN(rateAdjustment)) rateAdjustment = 0;
		return rateAdjustment;
	}
} setAdjustment();
